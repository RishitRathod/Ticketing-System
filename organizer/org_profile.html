<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Profile</title>
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- CSS -->
    <style>
        body{
            background-color: #ffffff;
        }
        .nav-pills li a:hover {
            background-color: darkblue;
        }

        .dropdown-menu a:hover {
            background-color: darkblue;
            color: #fff;
        }

        .main-content {
            border: 1px solid #ccc;
            border-radius: 5px;
            max-width: 1000px;
            margin: 20px auto;  
            padding: 20px;
            background-color: #f9f9f9;
            box-shadow:0 4px 8px 0 rgba(0, 0, 0, 0.2) ;
        }

        .sign {
            padding-top: 10px;
            color: #00111b;
            font-family: 'Ubuntu', sans-serif;
            font-weight: bold;
            font-size: 23px;
        }
    </style>
</head>
<body>
    <div class="container-fluid p-3 mb-2 bg-dark text-white">
        <div class="row align-items-center">
            <a class="col-auto p-3 ml-3 mr-auto" href="./organization_dashboard.html">
                <img src="../img/logo.png" height="80" class="rounded-circle" alt="Logo">
                <b class="h5 ml-2 text-light text-decoration-none">The Organizer</b>
            </a>  
            <div class="col-auto">
                <div class="dropdown open p-3 rounded-pills">
                    <button class="btn btn-secondary dropdown-toggle" type="button" id="triggerId" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <img src="../img/user.png" height="40" class="rounded-circle" alt="User">
                    </button>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="triggerId">
                        <a class="dropdown-item" href="./org_profile.html">Profile</a>
                        <a class="dropdown-item" href="./organization_logout.php">Log Out</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <div class="container-fluid">
        <div class="row flex-nowrap">
            <div class="bg-dark col-auto col-md-4 col-lg-3 min-vh-100 d-flex flex-column justify-content-between rounded-right">
                <div class="bg-dark p-2">
                    <ul class="nav nav-pills flex-column">
                        <li class="nav-item py-2">
                            <a href="./organization_dashboard.html" class="nav-link text-white"> 
                                <i class="fs-5 fa fa-tachometer"></i> <span class="fs-4 ms-3 d-none d-sm-inline">Dashboard</span>
                            </a>
                        </li>
                        <li class="nav-item py-2">
                            <a href="./organization_events.html" class="nav-link text-white"> 
                                <i class="fs-5 fa fa-list"></i> <span class="fs-4 ms-3 d-none d-sm-inline">Events</span>
                            </a>
                        </li>
                        <li class="nav-item py-2">
                            <a href="./organization_plans.html" class="nav-link text-white"> 
                                <i class="fs-5 fa fa-th"></i> <span class="fs-4 ms-3 d-none d-sm-inline">Plans</span>
                            </a>
                        </li>
                        <li class="nav-item py-2">
                            <a href="./organization_analysis.html" class="nav-link text-white"> 
                                <i class="fs-5 fa fa-clipboard"></i> <span class="fs-4 ms-3 d-none d-sm-inline">Analysis</span>
                            </a>
                        </li>
                        <li class="nav-item py-2">
                            <a href="./organization_members.html" class="nav-link text-white"> 
                                <i class="fs-5 fa fa-users"></i> <span class="fs-4 ms-3 d-none d-sm-inline">Members</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="main-content mx-2-auto d-flex justify-content-center ">
                <form id="registrationForm" class="form-container" action="" method="POST" id="editForm"> 
                    <p class="sign" align="center">Profile</p>
                    <div class="d-flex flex-column align-items-center mb-3">
                        <img src="../img/user.png" height="150" alt="Your Profile Photo" class="rounded-circle">
                    </div>
                    <div class="row">
                        <label for="name" class="m-3"> Organization Name </label>
                        <input type="text" name="name" id="name" class="col my-2 form-control" disabled> 
                        <label for="desc" class="m-3"> Package </label>
                        <input type="text" name="package" id="package" class="col my-2 form-control" disabled>
                        <input type="text" name="status" id="status">
                    </div>
                    <label for="email"> Email </label>
                    <input type="email" name="email" id="email" class="form-control" disabled>
                    <label for="pass"> Password </label>
                    <input type="text" name="pass" id="pass" class="form-control" disabled> 
           

                    <fieldset class="mt-3">
                        <legend>  Contact Details </legend>
                        <div class="row">
                            <label for="co_name" class="m-3"> Name </label>
                            <input type="text" name="co_name" id="co_name" class="col my-2 form-control" disabled>
                        </div>
                        <div class="row">
                            <label for="co_email" class="m-3"> Email </label>
                            <input type="email" name="co_email" id="co_email"  class="col my-2 form-control"disabled>
                            <label for="co_number" class="m-3"> Number </label>
                            <input type="text" name="co_number" id="co_number" class="col my-2 form-control" disabled>
                        </div>
                    </fieldset>
                    <fieldset>
                        <legend> Status </legend>
                        <div id="status">
                        </div>
                    </fieldset>
                    <input type="hidden" id="OrgID" name="OrgID">
                    <button type="button" id="edit" name="edit" onclick="editProfile()">Edit</button>
                    <button type="submit" id="submit" name="submit" onclick="updateprofile()" hidden>Submit</button>
                </form>             
            </div>
        </div>
    </div>  


    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>   

    <footer class="bg-body-tertiary p-3 text-center text-lg-start">
    <!-- Copyright -->
        <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.05);">
            Â© 2024 Copyright:
            <a class="text-body" href="#"> Event Scheduler </a>
        </div>
    <!-- Copyright -->
    </footer>
    <script src="../script.js"></script>
    <script>
        let userData;

        document.addEventListener('DOMContentLoaded', async function() {
            userData = await getUser();
            console.log(userData[0].OrgID);
            
            if (userData && userData.length > 0) {
                document.getElementById('name').value = userData[0].Name;
                document.getElementById('email').value = userData[0].Email;
                document.getElementById('pass').value = userData[0].Password;
                document.getElementById('co_email').value = userData[0].ContactEmail;
                document.getElementById('co_number').value = userData[0].ContactNumber;
                document.getElementById('co_name').value = userData[0].ContactName;
                document.getElementById('OrgID').value = userData[0].OrgID;
            }
        });

        function editProfile() {
    document.getElementById('submit').removeAttribute('hidden');
    document.getElementById('name').removeAttribute('disabled');
    document.getElementById('co_email').removeAttribute('disabled');
    document.getElementById('co_number').removeAttribute('disabled');
    document.getElementById('co_name').removeAttribute('disabled');
    document.getElementById('OrgID').removeAttribute('hidden');
}
function updateprofile() {
    // Hide the submit button
    document.getElementById('submit').style.display = 'none';
    
    // Prevent the default form submission behavior
    event.preventDefault();
    
    // Get the form data
    const name = document.querySelector("#name").value;
    const contactName = document.querySelector("#co_name").value;
    const contactNumber = document.querySelector("#co_number").value;
    const contactEmail = document.querySelector("#co_email").value;
    const orgID = document.querySelector("#OrgID").value;
    
    // Construct the data object
    var data = {
        "Name": name,
        "ContactName": contactName,
        "ContactNumber": contactNumber,
        "ContactEmail": contactEmail,
        "Tablename": "organizations",
        "OrgID": orgID,
    };
    
    // Send the form data to the server
    fetch("org_profile.php", {
        method: "POST",
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data),
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json();
    })
    .then(data => {
        console.log('Response from server:', data);
        // Handle the response data here
    })
    .catch(error => {
        console.error('Error:', error);
    });
}


    
    
    </script>

</body>
</html>
