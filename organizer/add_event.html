<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Registration</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .step {
            display: none;
        }
        .step.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h2>Event Registration</h2>
                    </div>
                    <div class="card-body">
                        <form id="registrationForm" method="post" enctype="multipart/form-data">
                            <!-- Step 1: Basic Information -->
                            <div class="step active">
                                <div class="form-group">
                                    <label for="orgid">Event Name</label>
                                    <input type="text" class="form-control" id="orgid" name="orgid" >
                                </div>
                                <div class="form-group">
                                    <label for="eventName">Event Name</label>
                                    <input type="text" class="form-control" id="eventName" name="EventName" >
                                </div>
                                <div class="form-group">
                                    <label for="eventType">Event Type</label>
                                    <select class="form-control" id="eventType" name="EventType" >
                                        <option value="">Select event type</option>
                                        <option value="Beauty">Beauty</option>
                                        <option value="Business">Business</option>
                                        <option value="Comedy">Comedy</option>
                                        <option value="Culture">Culture</option>
                                        <option value="Dance">Dance</option>
                                        <option value="Education">Education</option>
                                        <option value="Experience">Experience</option>
                                        <option value="Health">Health</option>
                                        <option value="Music">Music</option>
                                        <option value="Sports">Sports</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="description">Description</label>
                                    <textarea class="form-control" id="description" name="Description"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="capacity">Capacity</label>
                                    <input type="number" class="form-control" id="capacity" name="Capacity">
                                </div>
                                <div class="form-group">
                                    <label for="startDate">Start Date</label>
                                    <input type="datetime-local" class="form-control" id="startDate" name="StartDate" >
                                </div>
                                <div class="form-group">
                                    <label for="endDate">End Date</label>
                                    <input type="datetime-local" class="form-control" id="endDate" name="EndDate" >
                                </div>
                                <button type="button" class="btn btn-primary next-step">Next</button>
                            </div>

                            <!-- Step 2: Date and Time -->
                            <div class="step">
                                <div id="timeSlotsContainer">
                                    <div class="time-slot-group">
                                        <div class="form-group">
                                            <label for="startTimeSlot1">Start Time Slot 1</label>
                                            <input type="time" class="form-control" id="startTimeSlot1" name="StartTimeSlot[]">
                                            <label for="endTimeSlot1">End Time Slot 1</label>
                                            <input type="time" class="form-control" id="endTimeSlot1" name="EndTimeSlot[]">
                                            <button type="button" class="btn btn-danger remove-time-slot">Remove</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <button type="button" class="btn btn-secondary" id="addTimeSlot">Add Time Slot</button>
                                </div>
                                <button type="button" class="btn btn-secondary prev-step">Previous</button>
                                <button type="button" class="btn btn-primary next-step">Next</button>
                            </div>
                            

                            <!-- Step 3: Ticket Information -->
                            <div class="step">
                                <div id="ticketContainer">
                                    <div class="ticket-group">
                                        <div class="form-group">
                                            <label for="ticketType">Ticket Type</label>
                                            <select class="form-control" id="ticketType" name="TicketType[]" >
                                                <option value="">Select ticket type</option>
                                                <option value="VIP">VIP</option>
                                                <option value="Normal">Normal</option>
                                                <option value="Student">Student</option>
                                                <option value="Balcony">Balcony</option>
                                                <option value="Child">Child</option>
                                                <option value="Senior">Senior</option>
                                                <option value="LastMinute">Last Minute</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="quantity">Quantity</label>
                                            <input type="number" id="quantity" class="form-control" name="Quantity[]" >
                                        </div>
                                        <div class="form-group">
                                            <label for="returnable">Returnable</label>
                                            <select class="form-control" id="returnable" name="Returnable[]" >
                                                <option value="">Select returnable option</option>
                                                <option value="Yes">Yes</option>
                                                <option value="No">No</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="limitQuantity">Limit Quantity</label>
                                            <input type="number" class="form-control" name="LimitQuantity[]" >
                                        </div>
                                        <div class="form-group">
                                            <label for="discount">Discount</label>
                                            <input type="number" class="form-control" name="Discount[]" >
                                        </div>
                                        <div class="form-group">
                                            <label for="price">Price</label>
                                            <input type="number" class="form-control" name="Price[]" >
                                        </div>
                                        <button type="button" class="btn btn-danger remove-ticket">Remove</button>
                                    </div>
                                </div>
                                <button type="button" class="btn btn-secondary" id="addTicket">Add Ticket Type</button>
                                <button type="button" class="btn btn-secondary prev-step">Previous</button>
                                <button type="button" class="btn btn-primary next-step">Next</button>
                            </div>


                            <!-- Step 4: Venue and Capacity -->
                            <div class="step">
                                <div class="form-group">
                                    <label for="venueAddress">Venue Address</label>
                                    <input type="text" class="form-control" id="venueAddress" name="VenueAddress">
                                </div>
                                <div class="form-group">
                                    <label for="eventPoster">Event Poster</label>
                                    <input type="file" class="form-control-file" id="eventPoster" name="EventPoster">
                                </div>
                                <div class="form-group">
                                    <label for="venueCascadedDropdown">Venue Cascaded Dropdown</label>
                                    <input type="text" class="form-control" id="venueCascadedDropdown" name="VenueCascadedDropdown">
                                </div>
                                <div class="form-group">
                                    <label for="stateCityAddress">State/City Address</label>
                                    <input type="text" class="form-control" id="stateCityAddress" name="StateCityAddress">
                                </div>
                                <button type="button" class="btn btn-secondary prev-step">Previous</button>
                                <!-- <button type="button" onclick="submitForm()">Submit</button> -->
                                <button type="submit" class="btn btn-primary" onclick="submitForm()">Submit</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        
        document.addEventListener('DOMContentLoaded', function () {
    const addTimeSlotBtn = document.getElementById('addTimeSlot');
    const timeSlotsContainer = document.getElementById('timeSlotsContainer');
    let timeSlotCount = 1;

    addTimeSlotBtn.addEventListener('click', function() {
        const timeSlotGroup = document.createElement('div');
        timeSlotGroup.classList.add('time-slot-group');

        const timeSlotDiv = document.createElement('div');
        timeSlotDiv.classList.add('form-group');

        const startTimeLabel = document.createElement('label');
        startTimeLabel.textContent = `Start Time Slot ${timeSlotCount + 1}`;
        timeSlotDiv.appendChild(startTimeLabel);

        const startTimeInput = document.createElement('input');
        startTimeInput.type = 'time';
        startTimeInput.className = 'form-control';
        startTimeInput.name = `StartTimeSlot[]`;
        timeSlotDiv.appendChild(startTimeInput);

        const endTimeLabel = document.createElement('label');
        endTimeLabel.textContent = `End Time Slot ${timeSlotCount + 1}`;
        timeSlotDiv.appendChild(endTimeLabel);

        const endTimeInput = document.createElement('input');
        endTimeInput.type = 'time';
        endTimeInput.className = 'form-control';
        endTimeInput.name = `EndTimeSlot[]`;
        timeSlotDiv.appendChild(endTimeInput);

        const removeBtn = document.createElement('button');
        removeBtn.type = 'button';
        removeBtn.classList.add('btn', 'btn-danger', 'remove-time-slot');
        removeBtn.textContent = 'Remove';
        removeBtn.addEventListener('click', function() {
            timeSlotGroup.remove();
            timeSlotCount--;
        });
        timeSlotDiv.appendChild(removeBtn);

        timeSlotGroup.appendChild(timeSlotDiv);
        timeSlotsContainer.appendChild(timeSlotGroup);
        timeSlotCount++;
    });


            const nextBtns = document.querySelectorAll('.next-step');
            const prevBtns = document.querySelectorAll('.prev-step');
            const form = document.getElementById('registrationForm');
            const steps = form.querySelectorAll('.step');
            const addTicketBtn = document.getElementById('addTicket');
            const ticketContainer = document.getElementById('ticketContainer');

            let currentStep = 0;

            nextBtns.forEach(button => {
                button.addEventListener('click', () => {
                    if (currentStep < steps.length - 1) {
                        steps[currentStep].classList.remove('active');
                        currentStep++;
                        steps[currentStep].classList.add('active');
                    }
                });
            });

            prevBtns.forEach(button => {
                button.addEventListener('click', () => {
                    if (currentStep > 0) {
                        steps[currentStep].classList.remove('active');
                        currentStep--;
                        steps[currentStep].classList.add('active');
                    }
                });
            });

            form.addEventListener('submit', function(event) {
                event.preventDefault();
                console.log('Form submitted');

                var formData = new FormData(form);

                // Log form data entries
                for (let [key, value] of formData.entries()) {
                    console.log(`${key}: ${value}`);
                }
                //send data to server using fatch
                fetch('add_event.php', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                //if susseccful
                .then(data => {
                    console.log(data);
                    // You can redirect to another page here
                })
                //if not susseccful
                .catch(error => {
                    console.error('Error:', error);
                })
                // You can add your form submission logic here (e.g., AJAX request)
            });

            addTicketBtn.addEventListener('click', function() {
                const newTicketGroup = document.querySelector('.ticket-group').cloneNode(true);
                newTicketGroup.querySelectorAll('input, select').forEach(input => input.value = '');
                newTicketGroup.querySelector('.remove-ticket').addEventListener('click', function() {
                    newTicketGroup.remove();
                });
                ticketContainer.appendChild(newTicketGroup);
            });

            ticketContainer.addEventListener('click', function(event) {
                if (event.target.classList.contains('remove-ticket')) {
                    event.target.closest('.ticket-group').remove();
                }
            });
        });
    </script>
</body>
</html>
